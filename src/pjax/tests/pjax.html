<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Page</title>
</head>
<body class="yui3-skin-sam">

<div id="log"></div>
<iframe id="test-iframe" src="pjax-iframe.html" style="visibility: hidden;"></iframe>

<script src="../../../build/yui/yui.js"></script>
<script>
YUI.GlobalConfig = {
    allowRollup: false,
    filter: (window.location.search.match(/[?&]filter=([^&]+)/) || [])[1] || 'min',
    modules: {
        'pjax-test': {
            fullpath: 'pjax-test.js',
            requires: ['pjax-plugin', 'test']
        }
    }
};

var Y = YUI().use('test-console', function (Y) {
    var iframe      = document.getElementById('test-iframe'),
        iframeWin   = iframe.contentWindow || iframe.contentDocument.parentWindow,
        iframeDoc   = iframeWin.document,
        Test        = Y.Test,
        testConsole = new Y.Test.Console().render('#log');

    YUI({
        win  : iframeWin,
        doc  : iframeDoc,
        logFn: testConsole.log
    }).use('pjax-test', function (Y) {
        Y.Test.Runner.run();
        Y.Test.Runner.on('complete', function() {
            Test.Runner.run();
        });
    });
});
</script>

</body>
</html>
